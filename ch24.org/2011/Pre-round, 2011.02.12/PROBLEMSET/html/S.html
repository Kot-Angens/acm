<html>
<head><title>S. Loopz</title></head>
<body>
<div align="justify">

<h2>S. Loopz</h2>
<p>
Badarg, the fearless pirate, was attacked by aliens on his way back from the
treasure island. He can only escape by assembling his raft, stored
in the captain's cabin in a big, gilded box. His raft is made from PVC pipe sections,
which can be connected to form a single rectangular waterproof loop.
<p>
The raft is made of pipe segments, arrenged in x*y cells.  There are 6 different kind
of pipe segments (4 corners, a horizontal and a vertical).
<p>
A pipe section contains connected pipe segments that form a pipeline that has
exactly two endpoints, and those endpoints are not blocked by other segments in
the section. Badarg finds a set of such pipe sections in his box. His task is to
arrange and place them (by moving and rotating the sections) in a way that:
<ol>
	<li> the final setup is a single loop of pipes.
	<li> there must be exactly one pipe segment in each cell.
</ol>
<p>
Every input has a solution that uses all the pipe sections.

<h3>Input</h3>
<p>
The first line contains three integers: x, y, number of pipe sections.
Then the pipe section descriptions follows.
Each pipe section starts with a width,height line, followed by a 2d
matrix of pipe segments.
<p>
A pipe segment is identified with an integer, 0 means empty tile, the
meanings of the other identifiers can be seen in the table below:
<p>
<table align="center" border="1" cellpadding="2" cellspacing="2">
<tr><th>id<th>drawing<th>ascii<th>description
<tr><td>1<td><img src="pipe1.png"><td><pre>---</pre><td>horizontal pipe

<tr><td>2<td><img src="pipe2.png"><td><pre>|
|</pre><td>vertical pipe

<tr><td>3<td><img src="pipe3.png"><td><pre> __
|</pre><td>top left corner

<tr><td>4<td><img src="pipe4.png"><td><pre>__
  |</pre><td>top right corner
<tr><td>5<td><img src="pipe5.png"><td><pre>__|</pre><td>bottom right corner
<tr><td>6<td><img src="pipe6.png"><td><pre>|__</pre><td>bottom left corner
</table>

<h3>Output</h3>
<p>
The output should contain a line for each pipe section with three
integers describing three operations:
<ul>
<li> a rotation (r = 0..3); clock-wise, r*90 degrees
<li> a horizontal displacement of the left column of the section
 from the left edge of the map
<li> a vertical displacement of the top row of the section from the
top of the map
</ul>
<p>
(Badarg wears an eyepatch and cannot think in 3D - flipping the sections doesn't occur to him.)

<h3>Example input</h3>
<pre>
6 4 3
4 6
3 0 0 0
2 0 0 0
2 0 0 0
2 0 0 0
2 0 0 4
6 1 1 5
5 3
3 4 0 0 0
2 2 0 0 0
0 6 1 1 5
2 3
4 3
2 2
6 5
</pre>

<h3>Example output</h3>
<pre>
1 0 0
0 1 1
1 3 1
</pre>

</body>
</html>
